@using Microsoft.AspNetCore.Http;
@inject IHttpContextAccessor Accessor;
@{
    ViewData["Title"] = "Add New Employee";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string message = "";
    if (ViewData["Message"] != null)
    {
        message = ViewData["Message"].ToString();
    }
}

<div id="dashboard-main-container">
    @* <div class="title-main-container">
        <div class="content-container">
            <h4 style="font-size: 26px;" class="text-left"> <a href="@Url.Action("Index", "Employee")"> 
                <i class="fa-solid fa-arrow-left" style="margin: 25px;font-size: 25px;"></i></a> <i class="fa-solid fa-users" style="margin: 10px;"></i> @ViewData["Title"].ToString()</h4>
        </div>
    </div> *@
    <div class="title-main-container">
        <div class="content-container">
            <div style="display: flex; align-items: center;">
                @* <a href="@Url.Action("Index", "Employee")">
                    <i class="fa-solid fa-arrow-left" style="margin: 25px;font-size: 25px;"></i>
                </a> *@
                <h4 style="font-size: 26px;" class="text-left">@ViewData["Title"].ToString()</h4>
            </div>
            @Html.Partial("_UserDetails")
        </div>
    </div>
    <div class="main-container">
        @* <div id="grid-main-container">
            <div class="title-main-container-2">
                <div class="content-container" style="flex-direction: column; border-bottom: 1px solid var(--secondary-dark);">
                    <span class="text-left">Employee Information</span>
                </div>
            </div>
        </div> *@
        @* <div class="wizzard-progress-button">
            <button id="wizzard-prev">Previous</button>
            <button id="wizzard-next">Next</button>
        </div> *@
        <div class="wizzard-progress-steps">
            
            <div class="page-indicator">
                <div class="page active" id="page-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24">
                        <path fill="currentColor" fill-rule="evenodd" d="M12 21a9 9 0 1 0 0-18a9 9 0 0 0 0 18m-.232-5.36l5-6l-1.536-1.28l-4.3 5.159l-2.225-2.226l-1.414 1.414l3 3l.774.774z" clip-rule="evenodd" />
                    </svg>
                    <p class="page-number">01</p>
                    <p class="page-title">Employee Information</p>
                </div>
            </div>
            <div class="page-indicator">
                <div class="page " id="page-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24">
                        <path fill="currentColor" fill-rule="evenodd" d="M12 21a9 9 0 1 0 0-18a9 9 0 0 0 0 18m-.232-5.36l5-6l-1.536-1.28l-4.3 5.159l-2.225-2.226l-1.414 1.414l3 3l.774.774z" clip-rule="evenodd" />
                    </svg>
                    <p class="page-number">02</p>
                    <p class="page-title">Required Documents</p>
                </div>
            </div>
            <div class="page-indicator">
                <div class="page" id="page-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24">
                        <path fill="currentColor" fill-rule="evenodd" d="M12 21a9 9 0 1 0 0-18a9 9 0 0 0 0 18m-.232-5.36l5-6l-1.536-1.28l-4.3 5.159l-2.225-2.226l-1.414 1.414l3 3l.774.774z" clip-rule="evenodd" />
                    </svg>
                    <p class="page-number">03</p>
                    <p class="page-title">Payroll Information</p>
                </div>
            </div>
            <div class="page-indicator">
                <div class="page" id="page-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24">
                        <path fill="currentColor" fill-rule="evenodd" d="M12 21a9 9 0 1 0 0-18a9 9 0 0 0 0 18m-.232-5.36l5-6l-1.536-1.28l-4.3 5.159l-2.225-2.226l-1.414 1.414l3 3l.774.774z" clip-rule="evenodd" />
                    </svg>
                    <p class="page-number">04</p>
                    <p class="page-title">Address Information</p>
                </div>
            </div>
            <div class="page-indicator">
                <div class="page" id="page-5">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24">
                        <path fill="currentColor" fill-rule="evenodd" d="M12 21a9 9 0 1 0 0-18a9 9 0 0 0 0 18m-.232-5.36l5-6l-1.536-1.28l-4.3 5.159l-2.225-2.226l-1.414 1.414l3 3l.774.774z" clip-rule="evenodd" />
                    </svg>
                    <p class="page-number">05</p>
                    <p class="page-title">Contact Information</p>
                </div>
            </div>
        </div>
        <div class="top-main-container">
                <div class="content-filter-nm">
                    <div class="sub-content">
                        <form action="" class="mod-form" id="employeeForm">
                            <div class="body-container page-container" id="page-1-container">
                                <div class="page-title-header">
                                    <div class="page-title">
                                        <h4>Employee Information</h4>
                                        <div class="title-underline"></div>
                                    </div>
                                </div>

                                <div class="employee-info-section">
                                    <div class="profile-container">
                                        <div class="upload-image-preview1" id="upload-image-preview" >
                                            <img src="/img//blank-profile-picture-png.webp" alt="" />
                                        </div>
                                        <div class="button-holder">
                                            <label for="img">Upload Image</label>
                                            <input type="file"
                                                   value=""
                                                   id="img"
                                                   class="mod-input img-choose"
                                                   name="uploadimg"  accept=".webp, .gif, .png,.jpg"/>
                                        </div>
                                    </div>
                                    <div class="form-holder">
                                        <div class="mod-form-row">
                                            <div class="input-container-whole focus-field">
                                                <input type="text" value="" id="empid" class="mod-input" disabled focus/>
                                                <label class="label-color label" for="empid">Employee ID #</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <select id="department" class="mod-input" style="width:100%" required>
                                                    <option value="" disabled selected>Select Department</option>
                                                </select>
                                                <label class="label-color label" for="department">Department </label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <select id="position" class="mod-input" style="width:100%" required>
                                                    <option value="" disabled selected>Select Position</option>
                                                </select>
                                                <label class="label-color label" for="department">Postion </label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <select id="poslevel" class="mod-input" style="width:100%" required>
                                                    <option value="" disabled selected>Select Position Level</option>
                                                </select>
                                                <label class="label-color label" for="department">Postion Level</label>
                                                <div class="underline"></div>
                                            </div>
                                        </div>
                                        <div class="mod-form-row">
                                            <div class="input-container-whole">
                                                <select id="emptype" class="mod-input" style="width:100%" required>
                                                    <option value="" disabled selected>Select Employee Type</option>
                                                </select>
                                                <label class="label-color label" for="department">User Type</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <select id="uType" class="mod-input" required>
                                                    <option value="" disabled selected>Select Employee Type</option>
                                                </select>
                                                <label class="label-color label" for="department">Employee Type</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <select id="manager" class="mod-input" style="width:100%" required>
                                                    <option value="" disabled selected>Select manager</option>
                                                </select>
                                                <label class="label-color label" for="department">Manager</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole date">
                                                <label class="label-color label" for="datehired">Date Hired</label>
                                                <input type="date" id="datehired" value="@DateTime.Now.ToString("yyyy-MM-dd")" class="mod-input" />
                                                <div class="underline"></div>
                                            </div>
                                        </div>
                                        <div class="mod-form-row">
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="lname" class="mod-input" required />
                                                <label class="label-color label" for="lname">Last Name</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="fname" class="mod-input" required />
                                                <label class="label-color label" for="fname">First Name</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="mname" class="mod-input" required />
                                                <label class="label-color label" for="mname">Middle Name</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="suffix" class="mod-input"  />
                                                <label class="label-color label" for="mname">Suffix</label>
                                                <div class="underline"></div>
                                            </div>
                                            @*<div class="input-container-whole">
                                                <input type="text" value="" id="suffix" class="mod-input" />
                                                <label class="label-color label" for="suffix">Suffix</label>
                                                <div class="underline"></div>
                                            </div> *@
                                        </div>
                                        <div class="mod-form-row">
                                            <div class="input-container-whole">
                                                <select id="gender" class="mod-input" required>
                                                    <option value="" disabled selected></option>
                                                    <option value="Male">Male</option>
                                                    <option value="Female">Female</option>
                                                </select>
                                                <label class="label-color label" for="gender">Gender</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="email" class="mod-input" required />
                                                <label class="label-color label" for="email">Email</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole focus-field">
                                                <input type="text" value="@@odecci.com" id="domain" class="mod-input"  disabled focus/>
                                                <label class="label-color  label" for="doamin">Domain</label>
                                                <div class="underline"></div>
                                            </div>
                                            <div class="input-container-whole">
                                                <input type="number" value="" id="cno" class="mod-input" required />
                                                <label class="label-color label" for="cno">Contact #</label>
                                                <div class="underline"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="body-container page-container" id="page-2-container">
                                <div class="page-title-header">
                                    <div class="page-title">
                                        <h4>Required Documents</h4>
                                        <div class="title-underline"></div>
                                    </div>
                                </div>
                                <div class="card-holder-row">
                                    @* SSS *@
                                    <div class="required-documents-card">
                                        <h4>Socail Security System (SSS)</h4>
                                        <span>Please upload file in pdf format and make sure the file size is under 25 MB</span>
                                        <div class="mod-form-row">
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="sss-id" class="mod-input" required />
                                                <label class="label-color label" for="email">SSS Number</label>
                                                <div class="underline"></div>
                                            </div>
                                        </div>
                                        <div class="upload-container">
                                            <div class="drop-area" id="drop-area">
                                                <p>Choose a file or drag & drop it here</p>
                                                <input type="file" id="sssfile" accept=".pdf" hidden />
                                                <a class="browse-file-btn"onclick="document.getElementById('sssfile').click()">Browse File</a>
                                            </div>
                                            <div id="file-list"></div>
                                        </div>
                                    </div>
                                    @* Pagibig *@
                                    <div class="required-documents-card">
                                        <h4>PagIbig</h4>
                                        <span>Please upload file in pdf format and make sure the file size is under 25 MB</span>
                                        <div class="mod-form-row">
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="pagibig-id" class="mod-input" required />
                                                <label class="label-color label" for="email">PagIbig MID Number</label>
                                                <div class="underline"></div>
                                            </div>
                                        </div>
                                        <div class="upload-container">
                                        <div class="drop-area" id="pagibig-drop-area">
                                                <p>Choose a file or drag & drop it here</p>
                                                <input type="file" id="pagibigfile" accept=".pdf" hidden />
                                                <a class="browse-file-btn"onclick="document.getElementById('pagibigfile').click()">Browse File</a>
                                            </div>
                                            <div id="pagibig-file-list"></div>
                                        </div>
                                    </div>
                                    @* PhilHealth *@
                                    <div class="required-documents-card">
                                        <h4>PhilHealth</h4>
                                        <span>Please upload file in pdf format and make sure the file size is under 25 MB</span>
                                        <div class="mod-form-row">
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="philhealth-id" class="mod-input" required />
                                                <label class="label-color label" for="email">PhilHealth MID Number</label>
                                                <div class="underline"></div>
                                            </div>
                                        </div>
                                        <div class="upload-container">
                                            <div class="drop-area" id="philhealth-drop-area">
                                                <p>Choose a file or drag & drop it here</p>
                                                <input type="file" id="philhealthfile" accept=".pdf" hidden />
                                                <a class="browse-file-btn"onclick="document.getElementById('philhealthfile').click()">Browse File</a>
                                            </div>
                                            <div id="philhealth-file-list"></div>
                                        </div>
                                    </div>
                                    @* Tax *@
                                    <div class="required-documents-card">
                                        <h4>Tax Identification Number</h4>
                                        <span>Please upload file in pdf format and make sure the file size is under 25 MB</span>
                                        <div class="mod-form-row">
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="tax-id" class="mod-input" required />
                                                <label class="label-color label" for="email">Tax Identification Number</label>
                                                <div class="underline"></div>
                                            </div>
                                        </div>
                                        <div class="upload-container">
                                        <div class="drop-area" id="tax-drop-area">
                                                <p>Choose a file or drag & drop it here</p>
                                                <input type="file" id="taxfile" accept=".pdf" hidden />
                                            <a class="browse-file-btn" onclick="document.getElementById('taxfile').click()">Browse File</a>
                                            </div>
                                        <div id="tax-file-list"></div>
                                        </div>
                                    </div>
                                    @* Other *@
                                    <div class="required-documents-card">
                                        <h4>Other Document</h4>
                                        <span>Please upload file in pdf format and make sure the file size is under 25 MB</span>
                                        @* <div class="mod-form-row">
                                            <div class="input-container-whole">
                                                <input type="text" value="" id="tax-id" class="mod-input" required />
                                                <label class="label-color label" for="email">Tax Identification Number</label>
                                                <div class="underline"></div>
                                            </div>
                                        </div> *@
                                        <div class="upload-container">
                                            <div class="drop-area" id="other-drop-area">
                                                <p>Choose a file or drag & drop it here</p>
                                                <input type="file" id="otherfile" multiple accept=".pdf,.png,.jpg" hidden />
                                                <a class="browse-file-btn" onclick="document.getElementById('otherfile').click()">Browse File</a>
                                            </div>
                                        <div id="other-file-list"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="body-container page-container" id="page-3-container">
                                <div class="page-title-header">
                                    <div class="page-title">
                                        <h4>Payroll Information</h4>
                                        <div class="title-underline"></div>
                                    </div>
                                </div>
                                <div class="payroll-section"> 
                                    <div class="mod-form-row">
                                        <div class="input-container-whole">
                                            <select id="salarytype" class="mod-input" style="width:100%" required>
                                                <option value="" disabled selected>Select Salary Type</option>
                                            </select>
                                            <label class="label-color label" for="salarytype">Salary Type </label>
                                            <div class="underline"></div>
                                        </div>
                                        <div class="input-container-whole">
                                            <select id="payrolltype" class="mod-input" style="width:100%" required>
                                                <option value="" disabled selected>Select Payroll Type</option>
                                            </select>
                                            <label class="label-color label" for="payrolltype">Payroll Type </label>
                                            <div class="underline"></div>
                                        </div>
                                        <div class="input-container-whole">

                                            <input type="number" value="" id="rate" class="mod-input" required />
                                        <label class="label-color label" for="rate">Rate</label>
                                            <div class="underline"></div>
                                        </div>
                                        <div class="input-container-whole">
                                            <input type="number" value="" id="daysinmonth" class="mod-input" required step="0.01" min="0" />
                                            <label class="label-color label" for="daysinmonth">Days in Month</label>
                                            <div class="underline"></div>
                                        </div>
                                        @* <div class="input-container-whole">
                                        <label class="label-color" for="status">Status </label>
                                        <select id="status" class="mod-input" style="width:100%" required>
                                        <option value="" disabled selected>Select Status</option>
                                        <option value="1">ACTIVE</option>
                                        <option value="0">INACTIVE</option>
                                        </select>
                                        </div> *@

                                    </div>
                                </div>
                            </div>
                            <div class="body-container page-container" id="page-4-container">
                                <div class="page-title-header">
                                    <div class="page-title">
                                        <h4>Address Information</h4>
                                        <div class="title-underline"></div>
                                    </div>
                                </div>
                                @* <div class="emp_title">
                                    <div class="input-container-whole">
                                        <label class="label-color" for="cob">Country of Birth  </label>
                                        <input type="text" value="" id="cob" class="mod-input" required />
                                    </div>
                                </div> *@

                                <div class="address-section">
                                    <div class="mod-form-row">
                                        @* <div class="input-container-whole">
                                        <label class="label-color" for="region">Region</label>
                                        <input type="text" value="" id="region" class="mod-input"required />
                                        </div> *@
                                        <div class="input-container-whole">
                                            <input type="text" value="" id="cob" class="mod-input" required />
                                            <label class="label-color label" for="cob">Country of Birth  </label>
                                            <div class="underline"></div>
                                        </div>
                                        <div class="input-container-whole">
                                            <select id="region" class="mod-input" style="width:100%" required>
                                                <option value="0" disabled selected>1</option>
                                            </select>
                                            <label class="label-color label" for="region">Region</label>
                                            <div class="underline"></div>
                                        </div>
                                        @* <div class="input-container-whole">
                                        <label class="label-color" for="province">Province</label>
                                        <input type="text" value="" id="province" class="mod-input" required/>
                                        </div> *@
                                        <div class="input-container-whole">
                                            <select id="province" class="mod-input" style="width:100%" required>
                                                <option value="0" disabled selected></option>
                                            </select>
                                            <label class="label-color label" for="province">Province</label>
                                            <div class="underline"></div>
                                        </div>
                                        @* <div class="input-container-whole">
                                        <label class="label-color" for="municipality">Municipality </label>
                                        <input type="text" value="" id="municipality" class="mod-input" required/>
                                        </div> *@
                                        <div class="input-container-whole">
                                            <select id="municipality" class="mod-input" style="width:100%" required>
                                                <option value="0" disabled selected></option>
                                            </select>
                                            <label class="label-color label" for="province">Municipality</label>
                                            <div class="underline"></div>
                                        </div>
                                        @* <div class="input-container-whole">
                                        <label class="label-color" for="barangay">Barangay </label>
                                        <input type="text" value="" id="barangay" class="mod-input"required  />
                                        </div> *@
                                        <div class="input-container-whole">
                                            <select id="barangay" class="mod-input" style="width:100%" required>
                                                <option value="0" disabled selected></option>
                                            </select>
                                            <label class="label-color label" for="province">Barangay</label>
                                            <div class="underline"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="body-container page-container" id="page-5-container">
                                <div class="page-title-header">
                                    <div class="page-title">
                                    <h4>Emergency Contact</h4>
                                        <div class="title-underline"></div>
                                    </div>
                                </div>
                                <div class="contact-section">
                                    <div class="mod-form-row">
                                        <div class="input-container-whole">
                                            <input type="text" value="" id="ecname" class="mod-input" required />
                                            <input type="hidden" value="0" id="ecid" class="mod-input" />
                                            <label class="label-color label" for="ecname">Contact Name  </label>
                                            <div class="underline"></div>
                                        </div>
                                        <div class="input-container-whole">
                                            <input type="text" value="" id="relationship" class="mod-input" required />
                                            <label class="label-color label" for="relationship">Relationship</label>
                                            <div class="underline"></div>
                                        </div>
                                        <div class="input-container-whole">
                                            <input type="text" value="" id="ecnumber" class="mod-input" required />
                                            <label class="label-color label" for="ecnumber">Contact Number</label>
                                            <div class="underline"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            @* <div class="tbl-btn-container  page-container">
                                <div class="btn-footer-container" style="margin-right:45px; gap:20px">
                                    <button type="button" class="btn btn-danger" id="cancel-button" onclick="window.location.href='@Url.Action("Index", "Employee")'">
                                        <i class="fa-solid fa-xmark"></i> Cancel
                                    </button>
                                    <button class="btn btn-primary" id="add-info" title="Add New Employee">
                                        <i class="fa-solid fa-floppy-disk"></i> Save Information
                                    </button>
                                </div>
                            </div> *@

                        <div class="wizzard-progress-button">
                            <a type="button" class="btn btn-danger" id="employee-cancel-button" onclick="window.location.href='@Url.Action("Index", "Employee")'">
                                @* <i class="fa-solid fa-xmark"></i> *@ Cancel
                            </a>
                            <a id="wizzard-prev">Previous</a>
                            <a id="wizzard-next">Next</a>
                            <button class="btn btn-primary" id="employee-add-info" title="Add New Employee">
                                @* <i class="fa-solid fa-floppy-disk"></i> *@ Save Information
                            </button>
                        </div>
                        </form>
                    </div>
                </div>
            </div>
    </div>



</div>

@section Scripts {
    <script>
        let wizzardPage = 1;
        let page1 = document.getElementById('page-1');
        let page2 = document.getElementById('page-2');
        let page3 = document.getElementById('page-3');
        let page4 = document.getElementById('page-4');
        let page5 = document.getElementById('page-5');
        let pagecontainer1 = document.getElementById('page-1-container');
        let pagecontainer2 = document.getElementById('page-2-container');
        let pagecontainer3 = document.getElementById('page-3-container');
        let pagecontainer4 = document.getElementById('page-4-container');
        let pagecontainer5 = document.getElementById('page-5-container');
        var defaultCreadedBy = @Accessor.HttpContext.Session.GetString("Id");
        async function runFunction() {
            await addressDOM();
            getempdetails();
        }
        var img_edit = "";
        $(document).ready(function () {
            getRegionsData();
            addressDOM();
            WizzardFunction();
            getempdetails();

            sssfilesUpload();
            pagibigfilesUpload();
            philhealthUpload();
            taxUpload();
            otherUpload();
            // runFunction();
            $("input[name=uploadimg]").change(function () {

                if (this.files && this.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        var img = $('<img>').attr('src', e.target.result);
                        img.attr('height', '100%');
                        img.attr('width', '100%');
                        $('.upload-image-preview1').html(img);
                    };
                    reader.readAsDataURL(this.files[0]);
                }
            });
        });
        fetchpositionselect();
        fetchdepartmentselect();
        fetchusertypeselect();
        fetchpayrolltypeselect();
        fetchpositionlevelselect();
        fetchmanagerselect();
        fetchsalarytypeselect();
        fetchstatusselect();
        GetETypeListOption();
       

        async function getempdetails() {
            const data = { Id: localStorage.getItem('id') };
            // console.log(data.Id);
            if (data.Id != null) {
                $.ajax({
                    url: '/Employee/GetEmployeeDetails',
                    data: {
                        data: data,
                    },
                    type: "POST",
                    beforeSend: function () {
                        // showloadingoverlay();
                    },
                    datatype: "json",
                    success: function (response) {
                        console.log(response);
                        var array = response[0].address.split(',');
                        // console.log(array[1].replace(' ', ''));
                        // console.log(array[2].replace(' ', ''));
                        // console.log(array[3].replace(' ', ''));
                        // console.log(array[4].replace(' ', ''));
                        var prov = array[2].replace(' ', '').toString();
                        var city = array[3].replace(' ', '').toString();
                        var brgy = array[4].replace(' ', '').toString();
                        // console.log(prov);
                        // console.log(city);
                        // console.log(brgy);
                        if (array.length > 1) {

                            $("#province").removeAttr('disabled');
                            $("#municipality").removeAttr('disabled');
                            $("#barangay").removeAttr('disabled');
                            // GetAllDataAddress();
                            $('#cob').val(array[0].replace(/\s+/g, '').replace(' ', ''));
                            $('#region').val(array[1].replace(' ', ''));
                            // getRegionsData();
                            // getProvinceData();
                            // document.getElementById('region').value = array[1].replace(' ', '');
                            // console.log(array[2].replace('/t', '').replace(' ', ''));
                            if ($('#region').val() != '0') {
                                // alert($('#region').val());
                                // getProvinceData();
                                var region = $("#region option:selected").data('id').toString().trim();
                                region = parseInt(region, 10);
                                // alert(region);

                                $.ajax({
                                    type: "GET",
                                    url: "../../../excel/barangay_files/refprovince.csv",
                                    dataType: "text",
                                    success: function (data) {
                                        const array = data.toString().split("\n"); // Split CSV file into lines
                                        $("#province").empty();
                                        $("#province").append('<option value="0" disabled selected>Select Province</option>');

                                        for (var i = 0; i < array.length; i++) { // Start from 1 to skip the headers row
                                            let row = array[i].replaceAll('"', '').split(","); // Split each row by comma
                                            if (row[3] == region) { // Compare region with the 4th column
                                                $("#province").append('<option value="' + row[2] + '"  data-id="' + row[4] + '">' + row[2] + "</option>");
                                                // $("#province").append('<option value="' + row[2]?.replaceAll('"', '') + '"  data-id="' + row[4]?.replaceAll('"', '') + '">' + row[2]?.replaceAll('"', '') + "</option>");
                                            }
                                        }

                                        $('#province').val(prov); // Assuming `prov` is already defined elsewhere
                                        // var province = $("#province option:selected").data('id');
                                        var province = $("#province option:selected").data('id').toString().trim();
                                        province = parseInt(province, 10);
                                        // alert(province);
                                        $.ajax({
                                            type: "GET",
                                            url: "../../../excel/barangay_files/refcitymun.csv",
                                            dataType: "text",
                                            success: function (data) {
                                                const array = data.toString().split("\n");
                                                $("#municipality").empty();
                                                $("#municipality").append('<option value="0" disabled selected>Select City</option>');
                                                for (var i = 0; i < array.length - 1; i++) {
                                                    let row = array[i].replaceAll('"', '').split(","); // Split each row by comma
                                                    //console.log(headers[2]);
                                                    if (row[4] == province) {
                                                        $("#municipality").append('<option value="' + row[2] + '"  data-id="' + row[5] + '">' + row[2] + "</option>");
                                                    }
                                                }
                                                $('#municipality').val(city);
                                                // var getselectedcity = $("#municipality option:selected").data('id');
                                                var getselectedcity = $("#municipality option:selected").data('id').toString().trim();

                                                getselectedcity = parseInt(getselectedcity, 10);
                                                // alert(getselectedcity);
                                                $.ajax({
                                                    type: "GET",
                                                    url: "../../../excel/barangay_files/refbrgy.csv",
                                                    dataType: "text",
                                                    success: function (data) {
                                                        const array = data.toString().split("\n");
                                                        $("#barangay").empty();
                                                        $("#barangay").append('<option value="0" disabled selected>Select Barangay</option>');
                                                        for (var i = 0; i < array.length - 1; i++) {
                                                            let row = array[i].replaceAll('"', '').split(",");
                                                            //console.log(headers[2]);
                                                            if (row[5] == getselectedcity) {
                                                                $("#barangay").append('<option value="' + row[2] + '">' + row[2].toUpperCase() + "</option>");
                                                            }

                                                        }
                                                        $('#barangay').val(brgy);
                                                    }
                                                });
                                            }
                                        });
                                    }
                                });

                            }
                            // $('#province').val(array[2].replace('/t', '').replace(' ', ''));
                            //document.getElementById('province').value = " PAMPANGA";//array[1].replace(' ', '');
                            // getCityData();
                            // $('#municipality').val(array[3].replace(' ', ''));
                            // getBarangayData();
                            // $('#barangay').val(array[4].replace(' ', ''));
                        }
                        else {
                            $('#cob').val(array[0]);
                        }
                        let date = new Date(response[0].dateStarted);
                        let formattedDate = date.toISOString().split('T')[0];
                        $('#empid').val(response[0].employeeID);
                        $('#position').val(response[0].position);
                        $('#poslevel').val(response[0].positionLevelId);
                        $('#manager').val(response[0].managerId);
                        $('#department').val(response[0].department);
                        $('#suffix').val(response[0].suffix);
                        $('#emptype').val(response[0].userType);
                        $('#uType').val(response[0].employeeType);
                        $('#lname').val(response[0].lname);
                        $('#fname').val(response[0].fname);
                        $('#mname').val(response[0].mname);
                        $('#email').val(response[0].username);
                        $('#cno').val(response[0].cno);
                        $('#gender').val(response[0].gender);
                        $('#datehired').val(formattedDate);
                        $('#payrolltype').val(response[0].payrollType);
                        $('#position').val(response[0].position);
                        $('#salarytype').val(response[0].salaryType);
                        $('#status').val(response[0].status);
                        $('#rate').val(response[0].rate);
                        $('#daysinmonth').val(response[0].daysInMonth);
                        $('#sss-id').val(response[0].ssS_Number);
                        $('#pagibig-id').val(response[0].pagIbig_MID_Number);
                        $('#philhealth-id').val(response[0].philHealth_Number);
                        $('#tax-id').val(response[0].tax_Identification_Number);
                        img_edit = response[0].filePath;
                        // console.log(img_edit);
                        // if (img_edit != "" || img_edit != null) {
                        //     var img = $('<img>').attr('src',img_edit);
                        //     img.attr('height', '100%');
                        //     img.attr('width', '100%');
                        //     img.css({
                        //         'object-fit': 'cover',  // Ensures the image covers the container
                        //         'object-position': 'top',  // Centers the image
                        //         'height': '100%',  // Sets height
                        //         'width': '100%',   // Sets width
                        //         'display': 'block'  // Ensures proper layout
                        //     });
                        //     $('.upload-image-preview1').html(img);
                        // }
                        if (img_edit == "" || img_edit == null) {
                            var img = $('<img>').attr('src', '/img/blank-profile-picture-png.webp');
                            // img.attr('height', '100%');
                            // img.attr('width', '100%');
                            $('.upload-image-preview1').html(img);
                        }
                        else{
                            var img = $('<img>').attr('src',img_edit);
                            img.attr('height', '100%');
                            img.attr('width', '100%');
                            img.css({
                                'object-fit': 'cover',  // Ensures the image covers the container
                                'object-position': 'top',  // Centers the image
                                'height': '100%',  // Sets height
                                'width': '100%',   // Sets width
                                'display': 'block'  // Ensures proper layout
                            });
                            $('.upload-image-preview1').html(img);
                        }

                    },
                    error: function (jqXHR, textStatus, errorThrown) {

                        console.error(textStatus, errorThrown);
                    },
                    complete: function () {

                        // hideloadingoverlay();
                    }
                });
                $.ajax({
                    url: '/Employee/GetECEmployeeDetails',
                    data: {
                        data: data,
                    },
                    type: "POST",
                    beforeSend: function () {
                        // showloadingoverlay();
                    },
                    datatype: "json",
                    success: function (response) {
                        // console.log(response);
                        if (response.length != 0) {
                            $('#ecid').val(response[0].id);
                            $('#ecname').val(response[0].name);
                            $('#relationship').val(response[0].relationship);
                            $('#ecnumber').val(response[0].phoneNumber);
                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {

                        console.error(textStatus, errorThrown);
                    },
                    complete: function () {

                        // hideloadingoverlay();
                    }
                });
            }
        }


        // getProvinceData();
        // getCityData();
        // getBarangayData();
    </script>
}